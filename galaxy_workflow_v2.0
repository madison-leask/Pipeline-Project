Input Raw Sequence Data
Input: Normal_231335_r1_chr5_12_17.fastq.gz, Normal_231335_r2_chr5_12_17.fastq.gz, Tumour_231336_r1_chr5_12_17.fastq.gz, Tumour_231336_r2_chr5_12_17.fastq.gz

Input Reference Genome
Input: hg19.chr5_12_17.fa.gz

Step 1: FastQC (Galaxy Version 0.73+galaxy0) on Raw Sequence Data 
Input: Normal_231335_r1_chr5_12_17.fastq.gz, Normal_231335_r2_chr5_12_17.fastq.gz, Tumour_231336_r1_chr5_12_17.fastq.gz, Tumour_231336_r2_chr5_12_17.fastq.gz
Output: html_file (html) & text_file (txt) x4

Step 2: Trimmomatic (Galaxy Version 0.38.1) on Tumour paired data 
Input: Tumour_231336_r1_chr5_12_17.fastq.gz & Tumour_231336_r2_chr5_12_17.fastq.gz
Output: fastq_out_r1_paired (input), fastq_out_r2_paired (input), fastq_out_r1_unpaired (input), fastq_out_r2_unpaired (input)

Step 3: Trimmomatic (Galaxy Version 0.38.1) on Normal paired data 
Input: Normal_231335_r1_chr5_12_17.fastq.gz & Normal_231335_r2_chr5_12_17.fastq.gz,
Output: fastq_out_r1_paired (input), fastq_out_r2_paired (input), fastq_out_r1_unpaired (input), fastq_out_r2_unpaired (input)

Step 4: FastQC (Galaxy Version 0.73+galaxy0) on Sequence data processed with Trimmomatic 
Input: fastq_out_r1_paired (input), fastq_out_r2_paired (input), fastq_out_r1_unpaired (input), fastq_out_r2_unpaired (input) x2
Output: html_file (html) & text_file (txt) x8

Step 5: Map with BWA-MEM (Galaxy Version 0.7.17.2) on Tumour paired data processed with Trimmomatic
Input: fastq_out_r1_paired (input) & fastq_out_r2_paired (input)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)

Step 6: Collect Alignment Summary Metrics (Galaxy Version 2.18.2.2) on Tumour paired alignment 
Input: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: outFile (tabular)

Step 7: Map with BWA-MEM (Galaxy Version 0.7.17.2) on Normal paired data processed with Trimmomatic
Input: fastq_out_r1_paired (input) & fastq_out_r2_paired (input)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)

Step 8: Collect Alignment Summary Metrics (Galaxy Version 2.18.2.2) on Normal paired alignment 
Input: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: outFile (tabular)

Step 9: Filter BAM datasets on a variety of attributes (Galaxy Version 2.5.2+galaxy1) on tumour and normal paired alignments
Input: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam) x2
 In “1: Filter”:
  “Select BAM property to filter on”: mapQuality
  “Filter on read mapping quality (phred scale)”: >=1
 In “2: Filter”:
  “Select BAM property to filter on”: isMapped
  “Selected mapped reads”: Yes
 In “3: Filter”:
  “Select BAM property to filter on”: isMateMapped
  “Select reads with mapped mate”: Yes
Output: out_file1 (bam) & out_file2 (txt) x2

Step 10: RmDup (Galaxy Version 2.0.1) on filtered alignments
Input: out_file1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: output1 (bam) x2

Step 11: BamLeftAlign (Galaxy Version 1.3.6) on processed alignments
Input: output1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: output_bam (bam) x2

Step 12: Samtools calmd to recalculate MD/NM tags (Galaxy Version 2.0.3) on left-aligned BAMs
Input: output_bam (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Advanced options: Coefficient to cap mapping quality of poorly mapped reads = 50
Output: calmd_output (bam) x2

Step 13: Filter BAM datasets on a variety of attributes (Galaxy Version 2.5.2+galaxy1) on processed alignments
Input: calmd_output (bam) x2
 In “1: Filter”:
  “Select BAM property to filter on”: mapQuality
  “Filter on read mapping quality (phred scale)”: <=254
Output:  out_file1 (bam) & out_file2 (txt) x2 

Step 14: Collect Alignment Summary Metrics (Galaxy Version 2.18.2.2) on processed BAMs
Input: out_file1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: outFile (tabular)

Step 15: MultiQC (Galaxy Version 1.11+galaxy1) on FastQC reports from all sequence data 
Input: text_file (txt) x12, outFile (tabular) x4
Output stats (input) & html_report (html)

Step 16: bedtools BAM to BED converter (Galaxy Version 2.30.0+galaxy2) on Normal processed alignment
Input: out_file1 (bam)
Output: output (bed)

Step 17: Exome Depth (Galaxy Version 1.1.0) on processed tumour & normal alignments
Input: out_file1 (bam) x2 
Output: output (tabular)

Step 18: VarScan Somatic (Galaxy Version 2.4.3.6) on tumour-normal sample pairs
Input: out_file1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
 Non-default options: 
  “Estimated purity (non-tumor content) of normal sample”: 1
  “Estimated purity (tumor content) of tumor sample”: 0.5
  “Generate separate output datasets for SNP and indel calls?”: No
  “Settings for Variant Calling”: Customize settings
  “Minimum base quality”: 28
  “Minimum mapping quality”: 1
Output: output (vcf), output_indel (vcf), output_snp (vcf)

Step 19: Input BED file
Input: BRCADirect.v1.0.bed

Step 20: SnpEff eff (Galaxy Version 4.3+T.galaxy2)
Input: output_snp (vcf), BRCADirect.v1.0.bed
Output: snpeff_output (vcf, bed)

Step 21: SnpEff eff (Galaxy Version 4.3+T.galaxy2)
Input: output (vcf), BRCADirect.v1.0.bed
Output: snpeff_output (vcf, bed)

Step 22: GEMINI load (Galaxy Version 0.20.1+galaxy2) 
Input: snpeff_output (vcf, bed)
Output: outfile (gemini.sqlite)

Step 23: GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), snpeff_output (vcf, bed)
Output: outfile (gemini.sqlite)

Input dbSNP data 
Input: dbsnp.b147.chr5_12_17.vcf

Step 24: GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), dbsnp.b147.chr5_12_17.vcf
Output: outfile (gemini.sqlite)

Input Cancer Hotspot data
Input: cancerhotspots_v2.bed

Step 25: GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), cancerhotspots_v2.bed
Output: outfile (gemini.sqlite)

Input CIViC data
Input: CIViC.bed

Step 26: GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), CIViC.bed
Output: outfile (gemini.sqlite)

Input Cancer Genome Interpreter data
Input: cgi_variant_positions.bed

Step 27: GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), cgi_variant_positions.bed
Output: outfile (gemini.sqlite)

Step 28: GEMINI query (Galaxy Version 0.20.1+galaxy1)
Input: outfile (gemini.sqlite)
 “Restrictions to apply to genotype values”: gt_alt_freqs.NORMAL <= 0.05 AND gt_alt_freqs.TUMOR >= 0.10
  “Additional constraints expressed in SQL syntax”: somatic_status = 2
Output: outfile (tabular, json, vcf)

Step 29: GEMINI query (Galaxy Version 0.20.1+galaxy1)
Input: outfile (gemini.sqlite)
 “Build GEMINI query using”: Advanced query constructor
 “The query to be issued to the database”: SELECT v.gene, v.chrom, g.synonym, g.hgnc_id, g.entrez_id, g.rvis_pct, v.clinvar_gene_phenotype FROM variants v, gene_detailed g WHERE v.chrom = g.chrom AND v.gene = g.gene AND v.somatic_status = 2 AND v.somatic_p <= 0.05 AND v.filter IS NULL GROUP BY g.gene
 “Genotype filter expression”: gt_alt_freqs.NORMAL <= 0.05 AND gt_alt_freqs.TUMOR >= 0.10
Output: outfile (tabular, json, vcf)

Input UniProt Cancer Genes
Input: uniprot_cancer_genes_13Feb2019.txt

Step 30: Join Two Files (Galaxy Version 1.1.2) to join UniProt Cancer Genes to database
Input: outfile (tabular, json, vcf) & uniprot_cancer_genes_13Feb2019.txt
Output: output (input)

Input CGI Genes
Input: cgi_genes.txt

Step 31: Join Two Files (Galaxy Version 1.1.2) to join CGI genes to database
Input: outfile (tabular, json, vcf) & cgi_genes.txt
Output: output (input)

Input CIViC Gene Summaries
Input: 01-Feb-2019-Gene-Summaries.tsv

Step 32: Join Two Files (Galaxy Version 1.1.2) to join CIViC Gene Summaries to database
Input: outfile (tabular, json, vcf) & 01-Feb-2019-Gene-Summaries.tsv
Output: output (input)

Step 33: Column arrange by header name (Galaxy Version 0.2)
Input: output (input) from Join CIViC Gene Summaries to database
 In “1: Specify the first few columns by name”
  “column”: gene
 In “2: Specify the first few columns by name”
  “column”: chrom
 In “3: Specify the first few columns by name”
  “column”: synonym
 In “4: Specify the first few columns by name”
  “column”: hgnc_id
 In “5: Specify the first few columns by name”
  “column”: entrez_id
 In “6: Specify the first few columns by name”
  “column”: rvis_pct
 In “7: Specify the first few columns by name”
  “column”: is_OG
 In “8: Specify the first few columns by name”
  “column”: is_TS
 In “9: Specify the first few columns by name”
  “column”: in_cgi_biomarkers
 In “10: Specify the first few columns by name”
  “column”: clinvar_gene_phenotype
 In “11: Specify the first few columns by name”
  “column”: gene_civic_url
 In “12: Specify the first few columns by name”
  “column”: description
 “Discard unspecified columns”: Yes
Output: output (tabular)
