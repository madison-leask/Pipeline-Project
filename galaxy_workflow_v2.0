Input Raw Sequence Data
Input: Normal_231335_r1_chr5_12_17.fastq.gz, Normal_231335_r2_chr5_12_17.fastq.gz, Tumour_231336_r1_chr5_12_17.fastq.gz, Tumour_231336_r2_chr5_12_17.fastq.gz

Input Reference Genome
Input: hg19.chr5_12_17.fa.gz

FastQC (Galaxy Version 0.73+galaxy0) on Raw Sequence Data 
Input: Normal_231335_r1_chr5_12_17.fastq.gz, Normal_231335_r2_chr5_12_17.fastq.gz, Tumour_231336_r1_chr5_12_17.fastq.gz, Tumour_231336_r2_chr5_12_17.fastq.gz
Output: html_file (html) & text_file (txt) x4

Trimmomatic (Galaxy Version 0.38.1) on Tumour paired data 
Input: Tumour_231336_r1_chr5_12_17.fastq.gz & Tumour_231336_r2_chr5_12_17.fastq.gz
Output: fastq_out_r1_paired (input), fastq_out_r2_paired (input), fastq_out_r1_unpaired (input), fastq_out_r2_unpaired (input)

Trimmomatic (Galaxy Version 0.38.1) on Normal paired data 
Input: Normal_231335_r1_chr5_12_17.fastq.gz & Normal_231335_r2_chr5_12_17.fastq.gz,
Output: fastq_out_r1_paired (input), fastq_out_r2_paired (input), fastq_out_r1_unpaired (input), fastq_out_r2_unpaired (input)

FastQC (Galaxy Version 0.73+galaxy0) on Sequence data processed with Trimmomatic 
Input: fastq_out_r1_paired (input), fastq_out_r2_paired (input), fastq_out_r1_unpaired (input), fastq_out_r2_unpaired (input) x2
Output: html_file (html) & text_file (txt) x8

Map with BWA-MEM (Galaxy Version 0.7.17.2) on Tumour paired data processed with Trimmomatic
Input: fastq_out_r1_paired (input) & fastq_out_r2_paired (input)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)

Collect Alignment Summary Metrics (Galaxy Version 2.18.2.2) on Tumour paired alignment 
Input: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: outFile (tabular)

Map with BWA-MEM (Galaxy Version 0.7.17.2) on Normal paired data processed with Trimmomatic
Input: fastq_out_r1_paired (input) & fastq_out_r2_paired (input)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)

Collect Alignment Summary Metrics (Galaxy Version 2.18.2.2) on Normal paired alignment 
Input: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam)
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: outFile (tabular)

Filter BAM datasets on a variety of attributes (Galaxy Version 2.5.2+galaxy1) on tumour and normal paired alignments
Input: bam_output (bam, qname_sorted.bam, qname_input_sorted.bam) x2
 In “1: Filter”:
  “Select BAM property to filter on”: mapQuality
  “Filter on read mapping quality (phred scale)”: >=1
 In “2: Filter”:
  “Select BAM property to filter on”: isMapped
  “Selected mapped reads”: Yes
 In “3: Filter”:
  “Select BAM property to filter on”: isMateMapped
  “Select reads with mapped mate”: Yes
Output: out_file1 (bam) & out_file2 (txt) x2

RmDup (Galaxy Version 2.0.1) on filtered alignments
Input: out_file1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: output1 (bam) x2

BamLeftAlign (Galaxy Version 1.3.6) on processed alignments
Input: output1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: output_bam (bam) x2

Samtools calmd to recalculate MD/NM tags (Galaxy Version 2.0.3) on left-aligned BAMs
Input: output_bam (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Advanced options: Coefficient to cap mapping quality of poorly mapped reads = 50
Output: calmd_output (bam) x2

Filter BAM datasets on a variety of attributes (Galaxy Version 2.5.2+galaxy1) on processed alignments
Input: calmd_output (bam) x2
 In “1: Filter”:
  “Select BAM property to filter on”: mapQuality
  “Filter on read mapping quality (phred scale)”: <=254
Output:  out_file1 (bam) & out_file2 (txt) x2 

Collect Alignment Summary Metrics (Galaxy Version 2.18.2.2) on processed BAMs
Input: out_file1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
Output: outFile (tabular)

MultiQC (Galaxy Version 1.11+galaxy1) on FastQC reports from all sequence data 
Input: text_file (txt) x12, outFile (tabular) x4
Output stats (input) & html_report (html)

VarScan Somatic (Galaxy Version 2.4.3.6) on tumour-normal sample pairs
Input: out_file1 (bam) x2
Input Reference Genome: hg19.chr5_12_17.fa.gz
 Non-default options: 
  “Estimated purity (non-tumor content) of normal sample”: 1
  “Estimated purity (tumor content) of tumor sample”: 0.5
  “Generate separate output datasets for SNP and indel calls?”: No
  “Settings for Variant Calling”: Customize settings
  “Minimum base quality”: 28
  “Minimum mapping quality”: 1
Output: output (vcf), output_indel (vcf), output_snp (vcf)

SnpEff eff (Galaxy Version 4.3+T.galaxy2)
Input: output (vcf)
Output: snpeff_output (vcf, bed)

GEMINI load (Galaxy Version 0.20.1+galaxy2) 
Input: snpeff_output (vcf, bed)
Output: outfile (gemini.sqlite)

GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), snpeff_output (vcf, bed)
Output: outfile (gemini.sqlite)

Input dbSNP data 
Input: dbsnp.b147.chr5_12_17.vcf

GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), dbsnp.b147.chr5_12_17.vcf
Output: outfile (gemini.sqlite)

Input Cancer Hotspot data
Input: cancerhotspots_v2.bed

GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), cancerhotspots_v2.bed
Output: outfile (gemini.sqlite)

Input CIViC data
Input: CIViC.bed

GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), CIViC.bed
Output: outfile (gemini.sqlite)

Input Cancer Genome Interpreter data
Input: cgi_variant_positions.bed

GEMINI annotate (Galaxy Version 0.20.1+galaxy2)
Input: outfile (gemini.sqlite), cgi_variant_positions.bed
Output: outfile (gemini.sqlite)

GEMINI query (Galaxy Version 0.20.1+galaxy1)
Input: outfile (gemini.sqlite)
 “Restrictions to apply to genotype values”: gt_alt_freqs.NORMAL <= 0.05 AND gt_alt_freqs.TUMOR >= 0.10
  “Additional constraints expressed in SQL syntax”: somatic_status = 2 AND somatic_p <= 0.05 AND filter IS NULL
Output: outfile (tabular, json, vcf)

GEMINI query (Galaxy Version 0.20.1+galaxy1)
Input: outfile (gemini.sqlite)
 “Build GEMINI query using”: Advanced query constructor
 “The query to be issued to the database”: SELECT v.gene, v.chrom, g.synonym, g.hgnc_id, g.entrez_id, g.rvis_pct, v.clinvar_gene_phenotype FROM variants v, gene_detailed g WHERE v.chrom = g.chrom AND v.gene = g.gene AND v.somatic_status = 2 AND v.somatic_p <= 0.05 AND v.filter IS NULL GROUP BY g.gene
 “Genotype filter expression”: gt_alt_freqs.NORMAL <= 0.05 AND gt_alt_freqs.TUMOR >= 0.10
Output: outfile (tabular, json, vcf)

Input BED file
Input: BRCADirect.v1.0.bed

SnpEff eff (Galaxy Version 4.3+T.galaxy2)
Input: output_snp (vcf), 
Output: snpeff_output (vcf, bed)


